---
title: "STT 461 Homework 2 Solutions"
author: "Paul Speaker"
date: "`r Sys.Date()`"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Quantile plotting. 

1. Recall that you can find quantiles with the quantile command. Take the values 0.1, 0.2, …, 0.9, and find the corresponding quantiles for the mpg variable in the cars_multi dataset, and create a scatterplot with the quantiles on the y axis, and the decimal values 0.1, …, 0.9 on the x. 
```{r}
library(tidyverse)
library(ggplot2)
carsm <- read.csv("cars_multi.csv")
```

```{r}
qu_df <- data.frame("x" = seq(0.1,0.9, by = 0.1), "quantiles" = quantile(carsm$mpg, seq(0.1,0.9, by = 0.1))) 
                    
ggplot(data = qu_df, aes(x = x, y = quantiles)) + geom_point()
```


2. Repeat (1), but use a facet command to create separate plots by origin code.
```{r}
mpgqu <- data.frame("x" = numeric(), "quantiles" = numeric(), "country" = numeric())
for(i in 1:3){
  temp <- filter(carsm, origin == i)
  for(j in seq(0.1,0.9, by = 0.1))
  mpgqu[nrow(mpgqu)+1,] = c(j, quantile(temp$mpg, j), temp$origin)
}
ggplot(data = mpgqu, aes(x = x, y = quantiles)) + geom_point() + facet_grid(as.factor(mpgqu$country))
```


3. For the function 
$$f(x, y, z) = x^2 + 2y^2 - 3xyz,$$
z only takes the values 0 and 1. Create a contour plot 
with ggplot that does separate graphs for the 2 values of z (with faceting).
```{r}
con_df <- data.frame("x" = numeric(), "y" = numeric(), "z" = numeric(), "f" = numeric())
x <- seq(-10,10, by = 0.1)
y <- seq(-10,10, by = 0.1)
z <- c(0,1)
fc <- function(x,y,z){
  value <- x^2 + 2*y^2 - 3*x*y*z
  return(value)
}
for(i in x){
  for(j in y){
    for(k in z){
      con_df[nrow(con_df)+1,] = c(i,j,k, fc(i,j,k))
    }
  }
}
ggplot(data = con_df, aes(x=x, y =y, z=f)) +geom_contour() +facet_grid(as.factor(z))
```



4. A fair die is rolled 30 times.
a. What is the probability that exactly half of the rolls are even numbers?
b. What is the probability that more than 20 of the rolls are even numbers?
c. What is the probability that less than 5 of the rolls are greater than 4?
```{r}
# (a)
dbinom(15,30,0.5)

# (b)
1 - pbinom(20, 30, 0.5)

# (c)
pbinom(4, 30, 2/3)
```


5. A web server gets typically pinged according to a Poisson process with rate 30/second.
a. Find the probability that the server gets pinged between 20 and 40 times in a particular second.
b. Calculate the number of seconds in a year
c. Use (b) to estimate the maximum number of pings in a single second over the course of a year
d. Often a web server creates alerts when the ping rate is alarmingly high (typically, the sign of a Denial of Service attack by a hacker). What would be a good rate to create such an alarm (and why)

```{r}
# for (a)
ppois(40, 30) - ppois(19, 30)

# for (b)
365 * 24 * 60 * 60

# for (c)
qpois(1- 1/31536000, 30)

# for (d)
# I would use some number around 64, as it balances the number of false positives and false negatives.
```

The number of minutes that a bus is late is modeled by the Uniform density on the interval (0, 5).
a. Draw a picture of the density function.

```{r}
unif_df <- data.frame("x" = seq(-1,6, by = 0.01), "pdf" = dunif(seq(-1,6, by = 0.01), 0, 5))
ggplot(data = unif_df, aes(x = x, y = pdf)) + geom_line()
```

b. What is the probability that the bus is more than 1 minutes late?
c. What is the conditional probability that the bus is more than 4 minutes late, given that it is already 3 minutes late?
```{r}
# (b)
1 - punif(1, 0, 5)
(1 - punif(4, 0, 5))/(1 - punif(3, 0, 5))
# Note: these questions can also be answered by appealing to the geometry of the distribution.
```
6. Using the normal density with mean = 50 cm and sd = 5 cm as a model for the length of catfish in a lake, answer the following questions. 
a. If a catfish is selected at random, what is the probability that it is more than 60 cm in length?
b. What is the length x such that exactly 10% of catfish are shorter than x?
c. What is the length y such that exactly 70% of catfish are longer than y?
```{r}
#for (a)
1 - pnorm(60,50,5)
#for(b)
qnorm(0.1,50,5)
#for (c)
qnorm(1 - 0.7, 50, 5)
```

Let X be a random variable with mean= 80 and sd = 10.
a. Compute P(mean - sd < X < mean + sd). Note that this is P(70 < X < 90).
b. Compute P(60 < X < 100). Note that this can be written as P(mean - 2sd < X < mean + 2sd).
c. Compute P(50 < X < 110). Note that this can be written as P(mean - 3sd < X < mean + 3sd).
d. The relationships among normal densities suggest that you should get the same answers to these three questions no matter what the values of mean and sd. Verify that this is true by calculating the same three quantities, but this time for a standard normal distribution, i.e., a normal distribution with mean = 0 and sd = 1

```{r}
# for (a)
pnorm(90,80,10) - pnorm(70,80,10)

# for (b)
pnorm(100,80,10) - pnorm(60,80,10)

# for (c)
pnorm(110,80,10) - pnorm(50,80,10)

# for (d)
pnorm(1,0,1) - pnorm(-1,0,1) # or just pnorm(1) - pnorm(-1)
pnorm(2) - pnorm(-2)
pnorm(3) - pnorm(-3)
```

