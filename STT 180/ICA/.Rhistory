specify(response = sleep_total) %>%
hypothesise(null = "point", med = 10) %>%
generate(reps = 10, type = "bootstrap") %>%
calculate(stat = "median")
msleep %>%
specify(response = sleep_total) %>%
hypothesise(null = "point", med = 10) %>%
generate(reps = 10000, type = "bootstrap") %>%
calculate(stat = "median")
msleep %>%
specify(response = sleep_total) %>%
hypothesise(null = "point", med = 10) %>%
generate(reps = 10, type = "bootstrap") %>%
calculate(stat = "median")
# remove Human from msleep for simulation
null.dist <- msleep %>%
specify(response = sleep_total) %>%
hypothesise(null = "point", med = 10) %>%
generate(reps = 10, type = "bootstrap") %>%
calculate(stat = "median")
hist(null.dist)
# remove Human from msleep for simulation
null.dist <- msleep %>%
specify(response = sleep_total) %>%
hypothesise(null = "point", med = 10) %>%
generate(reps = 10, type = "bootstrap") %>%
calculate(stat = "median")
null_dist <- as.numeric(null.dist)
# remove Human from msleep for simulation
null.dist <- msleep %>%
specify(response = sleep_total) %>%
hypothesise(null = "point", med = 10) %>%
generate(reps = 10, type = "bootstrap") %>%
calculate(stat = "median")
msleep %>%
ggplot( aes(x=sleep_total)) +
geom_histogram( binwidth=25, fill="#69b3a2", color="#e9ecef", alpha=0.9) +
ggtitle("Sleep Total") +
theme_ipsum() +
theme(
plot.title = element_text(size=15)
)
# remove Human from msleep for simulation
null.dist <- msleep %>%
specify(response = sleep_total) %>%
hypothesise(null = "point", med = 10) %>%
generate(reps = 10, type = "bootstrap") %>%
calculate(stat = "median")
msleep %>%
ggplot( aes(x=sleep_total)) +
geom_histogram( binwidth=25, fill="#69b3a2", color="#e9ecef", alpha=0.9) +
ggtitle("Sleep Total") +
theme(
plot.title = element_text(size=15)
)
# remove Human from msleep for simulation
null.dist <- msleep %>%
specify(response = sleep_total) %>%
hypothesise(null = "point", med = 10) %>%
generate(reps = 10, type = "bootstrap") %>%
calculate(stat = "median")
msleep %>%
ggplot( aes(x=null.dist)) +
geom_histogram( binwidth=25, fill="#69b3a2", color="#e9ecef", alpha=0.9) +
ggtitle("Sleep Total") +
theme(
plot.title = element_text(size=15)
)
# remove Human from msleep for simulation
null.dist <- msleep %>%
specify(response = sleep_total) %>%
hypothesise(null = "point", med = 10) %>%
generate(reps = 10, type = "bootstrap") %>%
calculate(stat = "median")
msleep %>%
ggplot( aes(x=sleep_total)) +
geom_histogram( binwidth=3, fill="#69b3a2", color="#e9ecef", alpha=0.9) +
ggtitle("Sleep Total") +
theme(
plot.title = element_text(size=15)
)
# remove Human from msleep for simulation
null.dist <- msleep %>%
specify(response = sleep_total) %>%
hypothesise(null = "point", med = 10) %>%
generate(reps = 10, type = "bootstrap") %>%
calculate(stat = "median")
msleep %>%
ggplot( aes(x=sleep_total)) +
geom_histogram() +
ggtitle("Sleep Total") +
theme(
plot.title = element_text(size=15)
)
# remove Human from msleep for simulation
null.dist <- msleep %>%
specify(response = sleep_total) %>%
hypothesise(null = "point", med = 10) %>%
generate(reps = 10, type = "bootstrap") %>%
calculate(stat = "median")
ggplot(null.dist, aes(stat)) + geom_histogram(binwidth = .5) + theme_custom()
msleep %>%
filter(name != "Human")
specify(response = sleep_total) %>%
hypothesise(null = "point", med = 10) %>%
generate(reps = 10000, type = "bootstrap") %>%
calculate(stat = "median")
msleep %>%
specify(response = sleep_total) %>%
hypothesise(null = "point", med = 10) %>%
generate(reps = 10000, type = "bootstrap") %>%
calculate(stat = "median")
# remove Human from msleep for simulation
null.dist <- msleep %>%
filter(name != "Human")
specify(response = sleep_total) %>%
hypothesise(null = "point", med = 10) %>%
generate(reps = 10000, type = "bootstrap") %>%
calculate(stat = "median")
ggplot(null.dist, aes(stat)) + geom_histogram(binwidth = .5) + theme_custom()
# remove Human from msleep for simulation
null.dist <- msleep %>%
filter(name == "Human")
specify(response = sleep_total) %>%
hypothesise(null = "point", med = 10) %>%
generate(reps = 10000, type = "bootstrap") %>%
calculate(stat = "median")
ggplot(null.dist, aes(stat)) + geom_histogram(binwidth = .5) + theme_custom()
# remove Human from msleep for simulation
null.dist <- msleep %>%
filter(name != "Human")
specify(response = sleep_total) %>%
hypothesise(null = "point", med = 10) %>%
generate(reps = 10000, type = "bootstrap") %>%
calculate(stat = "median")
ggplot(null.dist, aes(stat)) + geom_histogram(binwidth = .5) + theme_custom()
# remove Human from msleep for simulation
null.dist <- msleep %>%
filter(name != "Human")
specify(response = sleep_total) %>%
hypothesise(null = "point", med = 10) %>%
generate(reps = 10000, type = "bootstrap") %>%
calculate(stat = "median")
ggplot(null.dist, aes(stat)) + geom_histogram(binwidth = .5) + theme_custom()
# remove Human from msleep for simulation
null.dist <- msleep %>%
filter(name != "Human")
specify(response = sleep_total) %>%
hypothesise(null = "point", med = 10) %>%
generate(reps = 1000, type = "bootstrap") %>%
calculate(stat = "median")
ggplot(null.dist, aes(stat)) + geom_histogram(binwidth = .5) + theme_custom()
# remove Human from msleep for simulation
null.dist <- msleep %>%
filter(name != "Human")
specify(response = sleep_total) %>%
hypothesise(null = "point", med = 10) %>%
generate(reps = 10, type = "bootstrap") %>%
calculate(stat = "median")
ggplot(null.dist, aes(stat)) + geom_histogram(binwidth = .5) + theme_custom()
# remove Human from msleep for simulation
null.dist <- msleep %>%
filter(name != "Human")
specify(response = sleep_total) %>%
hypothesise(null = "point", med = 10) %>%
generate(reps = 10, type = "bootstrap") %>%
calculate(stat = "median")
# remove Human from msleep for simulation
null.dist <- msleep %>%
specify(response = sleep_total) %>%
hypothesise(null = "point", med = 10) %>%
generate(reps = 10, type = "bootstrap") %>%
calculate(stat = "median")
ggplot(null.dist, aes(stat)) + geom_histogram(binwidth = .5) + theme_custom()
# remove Human from msleep for simulation
null.dist <- msleep %>%
specify(response = sleep_total) %>%
hypothesise(null = "point", med = 10) %>%
generate(reps = 10000, type = "bootstrap") %>%
calculate(stat = "median")
ggplot(null.dist, aes(stat)) + geom_histogram(binwidth = .5) + theme_custom()
# remove Human from msleep for simulation
null.dist <- msleep %>%
filter(msleep$name != "Human")
specify(response = sleep_total) %>%
hypothesise(null = "point", med = 10) %>%
generate(reps = 10000, type = "bootstrap") %>%
calculate(stat = "median")
ggplot(null.dist, aes(stat)) + geom_histogram(binwidth = .5) + theme_custom()
# remove Human from msleep for simulation
null.dist <- msleep %>%
filter(msleep$name != "human")
specify(response = sleep_total) %>%
hypothesise(null = "point", med = 10) %>%
generate(reps = 10000, type = "bootstrap") %>%
calculate(stat = "median")
ggplot(null.dist, aes(stat)) + geom_histogram(binwidth = .5) + theme_custom()
# remove Human from msleep for simulation
null.dist <- msleep %>%
specify(response = sleep_total) %>%
hypothesise(null = "point", med = 10) %>%
generate(reps = 10000, type = "bootstrap") %>%
calculate(stat = "median")
ggplot(null.dist, aes(stat)) + geom_histogram(binwidth = .5) + theme_custom()
msleep %>%
filter(name != "Human") %>%
specify(response = sleep_total) %>%
hypothesise(null = "point", med = 10) %>%
generate(reps = 10000, type = "bootstrap") %>%
calculate(stat = "median")
# remove Human from msleep for simulation
null.dist <- msleep %>%
filter(name != "Human") %>%
specify(response = sleep_total) %>%
hypothesise(null = "point", med = 10) %>%
generate(reps = 10000, type = "bootstrap") %>%
calculate(stat = "median")
ggplot(null.dist, aes(stat)) + geom_histogram(binwidth = .5) + theme_custom()
# remove Human from msleep for simulation
null.dist <- msleep %>%
filter(name != "Human") %>%
specify(response = sleep_total) %>%
hypothesise(null = "point", med = 10) %>%
generate(reps = 10000, type = "bootstrap") %>%
calculate(stat = "median")
ggplot(null.dist, aes(stat)) + geom_histogram(binwidth = .5) + geom_vline(xintercept = 10.1) theme_custom()
# remove Human from msleep for simulation
null.dist <- msleep %>%
filter(name != "Human") %>%
specify(response = sleep_total) %>%
hypothesise(null = "point", med = 10) %>%
generate(reps = 10000, type = "bootstrap") %>%
calculate(stat = "median")
ggplot(null.dist, aes(stat)) + geom_histogram(binwidth = .5) + geom_vline(xintercept = 10.1) + theme_custom()
# remove Human from msleep for simulation
null.dist <- msleep %>%
filter(name != "Human") %>%
specify(response = sleep_total) %>%
hypothesise(null = "point", med = 7.5) %>%
generate(reps = 10000, type = "bootstrap") %>%
calculate(stat = "median")
ggplot(null.dist, aes(stat)) + geom_histogram(binwidth = .5) + geom_vline(xintercept = 10.1) + theme_custom()
msleep %>%
filter(name != "Human") %>%
specify(response = sleep_total) %>%
hypothesise(null = "point", med = 7.5) %>%
generate(reps = 10000, type = "bootstrap") %>%
calculate(stat = "median")
null.dist %>%
filter(stat >= 10.1) %>%
summarise(p_value = 2 * n() / nrow(null.dist))
null.dist %>%
filter(stat >= 10.1) %>%
summarise(p_value = 2 * n(82) / nrow(null.dist))
# remove Human from msleep for simulation
null.dist <- msleep %>%
filter(name != "Human") %>%
specify(response = sleep_total) %>%
hypothesise(null = "point", med = 7.5) %>%
generate(reps = 10000, type = "bootstrap") %>%
calculate(stat = "median")
ggplot(null.dist, aes(stat)) + geom_histogram(binwidth = .5) + geom_vline(xintercept = 10.1) + theme_custom()
null.dist %>%
filter(stat >= 10.1) %>%
summarise(p_value = 2 * n() / nrow(null.dist))
null.dist1 <- msleep %>%
filter(name != "Human") %>%
specify(response = sleep_total) %>%
hypothesise(null = "point", mu = 8) %>%
generate(reps = 10000, type = "bootstrap") %>%
calculate(stat = "mean")
ggplot(null.dist, aes(stat)) + geom_histogram(binwidth = .5) + geom_vline(xintercept = 10.4) + theme_custom()
null.dist %>%
filter(stat >= 10.4) %>%
summarise(p_value = 2 * n() / nrow(null.dist1))
null.dist1 <- msleep %>%
filter(name != "Human") %>%
specify(response = sleep_total) %>%
hypothesise(null = "point", mu = 8) %>%
generate(reps = 10000, type = "bootstrap") %>%
calculate(stat = "mean")
ggplot(null.dist1, aes(stat)) + geom_histogram(binwidth = .5) + geom_vline(xintercept = 10.4) + theme_custom()
null.dist1 <- msleep %>%
filter(name != "Human") %>%
specify(response = sleep_total) %>%
hypothesise(null = "point", mu = 9.5) %>%
generate(reps = 10000, type = "bootstrap") %>%
calculate(stat = "mean")
ggplot(null.dist1, aes(stat)) + geom_histogram(binwidth = .5) + geom_vline(xintercept = 10.4) + theme_custom()
null.dist %>%
filter(stat >= 10.4) %>%
summarise(p_value = 1 * n() / nrow(null.dist1))
boot.means <- msleep %>%
specify(response = sleep_total) %>%
generate(reps = 10000, type = "bootstrap") %>%
calculate(stat = "mean")
boot.means <- msleep %>%
specify(response = sleep_total) %>%
generate(reps = 10000, type = "bootstrap") %>%
calculate(stat = "mean")
ggplot(boot.means, aes(stat)) + geom_histogram(binwidth = .5)  + theme_custom()
boot.means <- msleep %>%
specify(response = sleep_total) %>%
generate(reps = 10000, type = "bootstrap") %>%
calculate(stat = "mean")
ggplot(boot.means, aes(stat)) + geom_histogram(binwidth = .5)  + theme_custom()
boot.means %>%
summarise(lower95 = quantile(stat, probs = 0.25))
(upper95 = quantile(stat, probs = .975))
boot.means <- msleep %>%
specify(response = sleep_total) %>%
generate(reps = 10000, type = "bootstrap") %>%
calculate(stat = "mean")
ggplot(boot.means, aes(stat)) + geom_histogram(binwidth = .5)  + theme_custom()
boot.means %>%
summarise(lower95 = quantile(stat, probs = 0.25),
(upper95 = quantile(stat, probs = .975))
boot.means <- msleep %>%
specify(response = sleep_total) %>%
generate(reps = 10000, type = "bootstrap") %>%
calculate(stat = "mean")
ggplot(boot.means, aes(stat)) + geom_histogram(binwidth = .5)  + theme_custom()
boot.means %>%
summarise(lower95 = quantile(stat, probs = 0.25),
(upper95 = quantile(stat, probs = .975)))
boot.means %>%
summarise(lower90 = quantile(stat, probs = 0.25),
(upper90 = quantile(stat, probs = .975),
(lower99 = quantile(stat, probs = 0.005),
(upper99 = quantile, stat, probs = .995))))
boot.means %>%
summarise(lower90 = quantile(stat, probs = 0.25),
(upper90 = quantile(stat, probs = .975)
(lower99 = quantile(stat, probs = 0.005)
(upper99 = quantile, stat, probs = .995))))
boot.means %>%
summarise(lower90 = quantile(stat, probs = 0.25),
(upper90 = quantile(stat, probs = .975),
(lower99 = quantile(stat, probs = 0.005),
(upper99 = quantile(stat, probs = .995)))))
boot.means <- msleep %>%
specify(response = sleep_total) %>%
generate(reps = 10000, type = "bootstrap") %>%
calculate(stat = "mean")
ggplot(boot.means, aes(stat)) + geom_histogram(binwidth = .5)  + theme_custom()
boot.means %>%
summarise(lower95 = quantile(stat, probs = .025),
(upper95 = quantile(stat, probs = .975)))
boot.means <- msleep %>%
specify(response = awake) %>%
generate(reps = 10000, type = "bootstrap") %>%
calculate(stat = "mean")
ggplot(boot.means, aes(stat)) + geom_histogram(binwidth = .5)  + theme_custom()
boot.means %>%
summarise(lower95 = quantile(stat, probs = .025),
(upper95 = quantile(stat, probs = .975)))
boot.means %>%
summarise(lower90 = quantile(stat, probs = .025),
upper90 = quantile(stat, probs = .975),
lower99 = quantile(stat, probs = 0.005),
upper99 = quantile(stat, probs = .995))
boot.means <- msleep %>%
specify(response = awake) %>%
generate(reps = 10000, type = "bootstrap") %>%
calculate(stat = "mean")
ggplot(boot.means, aes(stat)) + geom_histogram(binwidth = .5)  + theme_custom()
boot.means %>%
summarise(lower95 = quantile(stat, probs = .025),
upper95 = quantile(stat, probs = .975))
boot.sd <- msleep %>%
specify(response = awake) %>%
generate(reps = 10000, type = "bootstrap") %>%
calculate(stat = "sd")
# bootstrap samples change the stat to sd
# cutoff bounds
# save as vector
# visualize bootstrap sample means
boot.sd <- msleep %>%
specify(response = awake) %>%
generate(reps = 10000, type = "bootstrap") %>%
calculate(stat = "sd")
# bootstrap samples change the stat to sd
boot.sd %>%
summarise(lower95 = quantile(stat, probs = .025),
upper95 = quantile(stat, probs = .975))
# cutoff bounds
# save as vector
# visualize bootstrap sample means
boot.sd <- msleep %>%
specify(response = awake) %>%
generate(reps = 10000, type = "bootstrap") %>%
calculate(stat = "sd")
# bootstrap samples change the stat to sd
boot.sd %>%
summarise(lower95 = quantile(stat, probs = .025),
upper95 = quantile(stat, probs = .975))
# cutoff bounds
sd.sub <- function(x, lower = 3, upper = 5){
Cutoffs <- quantile(x, probs = c(lower,upper))
return(mean(x[x >= Cutoffs[1] & x <= Cutoffs[2]]))
}
# save as vector
# visualize bootstrap sample means
knitr::opts_chunk$set(echo = TRUE,
error = TRUE,
message = FALSE,
warning = FALSE,
comment = NA)
set.seed(3122019)
boot.means1 <- population %>%
specify(response = value) %>%
generate(reps = 10000, type = "bootstrap") %>%
calculate(stat = "prop")
knitr::opts_chunk$set(echo = TRUE,
error = TRUE,
message = FALSE,
warning = FALSE,
comment = NA)
set.seed(3122019)
library(tidyverse)
library(infer)
theme_custom <- function() {
theme_bw() +
theme(axis.title = element_text(size = 16),
title = element_text(size = 20),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
plot.caption = element_text(size = 10))
}
# create data frame shelter
driver <- as_tibble(rep(x = c("no", "yes"), times = c(21, 14)))
# verify 53% are yes as per the survey results from above
driver %>%
group_by(value) %>%
summarise(proportion = n() / nrow(driver))
null.dist <- driver %>%
specify(response = value, success = "yes") %>%
hypothesise(null = "point", p = 0.54) %>%
generate(reps = 10000, type = "simulate") %>%
calculate(stat = "prop")
ggplot(null.dist, aes(stat)) + geom_histogram() + geom_vline(xintercept = 0.4) + theme_custom()
null.dist %>%
filter(stat <=0.4) %>%
summarise(p_value=2*n()/nrow(null.dist))
boot.means <- driver %>%
specify(response = value, success = "yes") %>%
generate(reps = 10000, type = "bootstrap") %>%
calculate(stat = "prop")
boot.means %>%
summarise(lower95 = quantile(stat, probs = .025),
upper95 = quantile(stat, probs = .975))
population <- tibble(value = rnorm(n = 1000000, mean = 34, sd = 8))
sample.means <- population %>%
infer::rep_sample_n(size = 50, replace = TRUE, reps = 10000)
x_bar_reps<-sample.means%>%
group_by(replicate) %>%
summarise(x_bar = mean(value))
# Graphs sampling distribution
x_bar_reps %>%
ggplot(mapping = aes(x = x_bar)) +
geom_histogram(bins = 20, fill = "lightblue", color = "black") +
geom_vline(xintercept = 32.5, color = "black")
x_bar_reps %>%
filter(x_bar <= 32.5) %>%
summarize(p.value = n()/nrow(x_bar_reps))
x_bar_reps %>%
filter(x_bar <= 32.5) %>%
summarize(p.value = n()/nrow(x_bar_reps))
x_bar_reps
boot.means1 <- x_bar_reps %>%
specify(response = x_bar) %>%
generate(reps = 10000, type = "bootstrap") %>%
calculate(stat = "prop")
boot.means1 <- x_bar_reps %>%
specify(response = replicate, success = "x_bar") %>%
generate(reps = 10000, type = "bootstrap") %>%
calculate(stat = "prop")
boot.means1 <- x_bar_reps %>%
specify(response = x_bar_reps, success = "x_bar") %>%
generate(reps = 10000, type = "bootstrap") %>%
calculate(stat = "prop")
boot.means1 <- x_bar_reps %>%
specify(response = x_bar, success = "x_bar") %>%
generate(reps = 10000, type = "bootstrap") %>%
calculate(stat = "prop")
boot.means1 <- x_bar_reps %>%
specify(response = x_bar) %>%
generate(reps = 10000, type = "bootstrap") %>%
calculate(stat = "prop")
boot.means1 <- population %>%
specify(response = value) %>%
generate(reps = 100, type = "bootstrap") %>%
calculate(stat = "prop")
boot.means1 <- population %>%
specify(response = value) %>%
generate(reps = 100, type = "bootstrap") %>%
calculate(stat = "mean")
boot.means1 <- population %>%
specify(response = value) %>%
generate(reps = 100, type = "bootstrap") %>%
calculate(stat = "mean")
boot.means1 %>%
summarise(lower96 = quantile(stat, probs = .025),
upper96 = quantile(stat, probs = .975),
lower99 = quantile(stat, probs = 0.005),
upper99 = quantile(stat, probs = .995))
x_bar_reps %>%
summarise(lower96 = quantile(x_bar, probs = .02),
upper96 = quantile(x_bar, probs = .98),
lower99 = quantile(x_bar, probs = .005),
upper99 = quantile(x_bar, probs = .995))
library(knitr)
